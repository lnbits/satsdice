{% extends "public.html" %} {% block scripts %} {{ window_vars(user) }}
<script>
  const coinflipHaircut = parseInt('{{ coinflipHaircut }}')
  const coinflipMaxPlayers = parseInt('{{ coinflipMaxPlayers }}')
  const coinflipMaxBet = parseInt('{{ coinflipMaxBet }}')
  const coinflipGameId = '{{ coinflipGameId }}'
  const coinflipPageId = '{{ coinflipPageId }}'
  const coinflipWinner = '{{ coinflipWinner }}'
</script>
<script src="{{ static_url_for('satsdice/static', path='js/coinflip.js') }}"></script>
{% endblock %} {% block page %}
<q-card class="fixed-center q-pa-xl" style="width: 600px">
  <q-card-section class="q-pa-none" v-if="activeGame && !gameComplete">
    <center>
      <h3 class="q-my-none q-mb-xl">{{ coinflip.name }}</h3>
    </center>
    <div class="row">
      <div class="col">
        <center>
          <q-badge outline size="xl" color="secondary">
            <div class="text-subtitle1">
              No. of Players: {{coinflip.number_of_players}}
            </div>
          </q-badge>
        </center>
      </div>
      <div class="col">
        <center>
          <q-badge outline size="xl" color="secondary">
            <div class="text-subtitle1">Buy In: {{coinflip.buy_in}} sats</div>
          </q-badge>
        </center>
      </div>
      <div class="col">
        <center>
          <q-badge outline size="xl" color="secondary">
            <div class="text-subtitle1">
              Registration fee: {{coinflipHaircut}} %
            </div>
          </q-badge>
        </center>
      </div>
    </div>
    <q-form @submit="joinGame" class="q-gutter-md">
      <q-input
        label="Your LNadress"
        class="q-mt-lg"
        type="text"
        v-model="lnaddress"
        required
      ></q-input>
      <q-btn outline class="q-mt-lg" type="submit">Join Coinflip</q-btn>
      <q-btn
        class="q-ml-lg q-mt-md"
        unelevated
        dense
        size="col-md-5"
        icon="link"
        :color="($q.dark.isActive) ? 'grey-7' : 'grey-5'"
        @click="copyText"
        ><q-tooltip>Copy coinflip link</q-tooltip></q-btn
      >
    </q-form>
  </q-card-section>

  <q-card-section v-if="gameComplete" class="q-pa-none" v-else>
    <center>
      <h2 class="q-my-none">Game Complete</h2>
      <h5 class="q-my-none">{{coinflipWinner}} won!</h5>
      <q-icon color="teal" name="check" size="30em"></q-icon>
    </center>
  </q-card-section>
</q-card>

<q-dialog v-model="qr.show" position="top">
  <q-card class="q-pa-lg q-pt-xl lnbits__dialog-card">
    <q-responsive :ratio="1" class="q-mx-xl q-mb-md">
      <lnbits-qrcode
        :value="qr.payment_request"
        :options="{width: 800}"
        class="rounded-borders"
      ></lnbits-qrcode>
    </q-responsive>
    <div class="text-h6 q-mb-md">Pay this invoice to join the game</div>
    <div class="row q-mt-lg">
      <q-btn outline color="grey" @click="copyInvoice">Copy URL</q-btn>
      <q-btn v-close-popup flat color="grey" class="q-ml-auto">Close</q-btn>
    </div>
  </q-card>
</q-dialog>
{% endblock %}
